"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/visas/route";
exports.ids = ["app/api/visas/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvisas%2Froute&page=%2Fapi%2Fvisas%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvisas%2Froute.ts&appDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvisas%2Froute&page=%2Fapi%2Fvisas%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvisas%2Froute.ts&appDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_glennbundy_Desktop_visatrack_malta_app_api_visas_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/visas/route.ts */ \"(rsc)/./app/api/visas/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/visas/route\",\n        pathname: \"/api/visas\",\n        filename: \"route\",\n        bundlePath: \"app/api/visas/route\"\n    },\n    resolvedPagePath: \"/Users/glennbundy/Desktop/visatrack-malta/app/api/visas/route.ts\",\n    nextConfigOutput,\n    userland: _Users_glennbundy_Desktop_visatrack_malta_app_api_visas_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/visas/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ2aXNhcyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGdmlzYXMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ2aXNhcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmdsZW5uYnVuZHklMkZEZXNrdG9wJTJGdmlzYXRyYWNrLW1hbHRhJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmdsZW5uYnVuZHklMkZEZXNrdG9wJTJGdmlzYXRyYWNrLW1hbHRhJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNnQjtBQUM3RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3Zpc2F0cmFjay1tYWx0YS8/OTc1NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvZ2xlbm5idW5keS9EZXNrdG9wL3Zpc2F0cmFjay1tYWx0YS9hcHAvYXBpL3Zpc2FzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS92aXNhcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Zpc2FzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS92aXNhcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9nbGVubmJ1bmR5L0Rlc2t0b3AvdmlzYXRyYWNrLW1hbHRhL2FwcC9hcGkvdmlzYXMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3Zpc2FzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvisas%2Froute&page=%2Fapi%2Fvisas%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvisas%2Froute.ts&appDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/visas/route.ts":
/*!********************************!*\
  !*** ./app/api/visas/route.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/auth-helpers-nextjs */ \"(rsc)/./node_modules/@supabase/auth-helpers-nextjs/dist/index.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n\n\n\n\nconst dynamic = \"force-dynamic\";\nconst visaSchema = zod__WEBPACK_IMPORTED_MODULE_3__.object({\n    employee_id: zod__WEBPACK_IMPORTED_MODULE_3__.string().uuid(),\n    visa_type: zod__WEBPACK_IMPORTED_MODULE_3__.string().min(1),\n    permit_number: zod__WEBPACK_IMPORTED_MODULE_3__.string().optional(),\n    issue_date: zod__WEBPACK_IMPORTED_MODULE_3__.string(),\n    expiry_date: zod__WEBPACK_IMPORTED_MODULE_3__.string(),\n    country_issued: zod__WEBPACK_IMPORTED_MODULE_3__.string().optional(),\n    status: zod__WEBPACK_IMPORTED_MODULE_3__[\"enum\"]([\n        \"valid\",\n        \"expired\",\n        \"pending_renewal\"\n    ]).optional()\n});\nasync function GET(request) {\n    try {\n        const supabase = (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__.createRouteHandlerClient)({\n            cookies: next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies\n        });\n        const { data: { session } } = await supabase.auth.getSession();\n        if (!session) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json([]);\n        }\n        const { data: profile } = await supabase.from(\"profiles\").select(\"company_id\").eq(\"id\", session.user.id).single();\n        if (!profile?.company_id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json([]);\n        }\n        // Get all employees for this company first\n        const { data: employees } = await supabase.from(\"employees\").select(\"id, first_name, last_name, passport_number\").eq(\"company_id\", profile.company_id);\n        if (!employees || employees.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json([]);\n        }\n        const employeeIds = employees.map((e)=>e.id);\n        // Get all visas for these employees\n        const { data: visas, error } = await supabase.from(\"visas\").select(\"*\").in(\"employee_id\", employeeIds).order(\"expiry_date\", {\n            ascending: true\n        });\n        if (error) throw error;\n        // Attach employee info to each visa\n        const visasWithEmployees = visas?.map((visa)=>({\n                ...visa,\n                employee: employees.find((e)=>e.id === visa.employee_id)\n            }));\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json(visasWithEmployees || []);\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const supabase = (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_0__.createRouteHandlerClient)({\n            cookies: next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies\n        });\n        const { data: { session } } = await supabase.auth.getSession();\n        if (!session) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const validation = visaSchema.safeParse(body);\n        if (!validation.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json(validation.error, {\n                status: 400\n            });\n        }\n        const { data: profile } = await supabase.from(\"profiles\").select(\"company_id\").eq(\"id\", session.user.id).single();\n        if (!profile?.company_id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                error: \"No company\"\n            }, {\n                status: 403\n            });\n        }\n        // Verify employee belongs to company\n        const { data: employee } = await supabase.from(\"employees\").select(\"id\").eq(\"id\", validation.data.employee_id).eq(\"company_id\", profile.company_id).single();\n        if (!employee) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                error: \"Employee not found\"\n            }, {\n                status: 404\n            });\n        }\n        const { data: visa, error } = await supabase.from(\"visas\").insert({\n            ...validation.data,\n            status: validation.data.status || \"valid\"\n        }).select().single();\n        if (error) throw error;\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json(visa, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztZQUNKLEdBQUdILFdBQVcvQixJQUFJO1lBQ2xCTCxRQUFRb0MsV0FBVy9CLElBQUksQ0FBQ0wsTUFBTSxJQUFJO1FBQ3RDLEdBQ0NZLE1BQU0sR0FDTkksTUFBTTtRQUVYLElBQUlRLE9BQU8sTUFBTUE7UUFFakIsT0FBT3ZDLHFEQUFZQSxDQUFDd0IsSUFBSSxDQUFDb0IsTUFBTTtZQUFFN0IsUUFBUTtRQUFJO0lBQ2pELEVBQUUsT0FBT3dCLE9BQVk7UUFDakJRLFFBQVFSLEtBQUssQ0FBQyxjQUFjQTtRQUM1QixPQUFPdkMscURBQVlBLENBQUN3QixJQUFJLENBQUM7WUFBRWUsT0FBT0EsTUFBTVMsT0FBTztRQUFDLEdBQUc7WUFBRWpDLFFBQVE7UUFBSTtJQUNyRTtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdmlzYXRyYWNrLW1hbHRhLy4vYXBwL2FwaS92aXNhcy9yb3V0ZS50cz8zNWNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVJvdXRlSGFuZGxlckNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2UvYXV0aC1oZWxwZXJzLW5leHRqc1wiO1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcblxuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSBcImZvcmNlLWR5bmFtaWNcIjtcblxuY29uc3QgdmlzYVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgICBlbXBsb3llZV9pZDogei5zdHJpbmcoKS51dWlkKCksXG4gICAgdmlzYV90eXBlOiB6LnN0cmluZygpLm1pbigxKSxcbiAgICBwZXJtaXRfbnVtYmVyOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgaXNzdWVfZGF0ZTogei5zdHJpbmcoKSxcbiAgICBleHBpcnlfZGF0ZTogei5zdHJpbmcoKSxcbiAgICBjb3VudHJ5X2lzc3VlZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHN0YXR1czogei5lbnVtKFtcInZhbGlkXCIsIFwiZXhwaXJlZFwiLCBcInBlbmRpbmdfcmVuZXdhbFwiXSkub3B0aW9uYWwoKSxcbn0pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVJvdXRlSGFuZGxlckNsaWVudCh7IGNvb2tpZXMgfSk7XG4gICAgICAgIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuXG4gICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFtdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKFwicHJvZmlsZXNcIilcbiAgICAgICAgICAgIC5zZWxlY3QoXCJjb21wYW55X2lkXCIpXG4gICAgICAgICAgICAuZXEoXCJpZFwiLCBzZXNzaW9uLnVzZXIuaWQpXG4gICAgICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgICAgaWYgKCFwcm9maWxlPy5jb21wYW55X2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oW10pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IGFsbCBlbXBsb3llZXMgZm9yIHRoaXMgY29tcGFueSBmaXJzdFxuICAgICAgICBjb25zdCB7IGRhdGE6IGVtcGxveWVlcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKFwiZW1wbG95ZWVzXCIpXG4gICAgICAgICAgICAuc2VsZWN0KFwiaWQsIGZpcnN0X25hbWUsIGxhc3RfbmFtZSwgcGFzc3BvcnRfbnVtYmVyXCIpXG4gICAgICAgICAgICAuZXEoXCJjb21wYW55X2lkXCIsIHByb2ZpbGUuY29tcGFueV9pZCk7XG5cbiAgICAgICAgaWYgKCFlbXBsb3llZXMgfHwgZW1wbG95ZWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFtdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVtcGxveWVlSWRzID0gZW1wbG95ZWVzLm1hcCgoZSkgPT4gZS5pZCk7XG5cbiAgICAgICAgLy8gR2V0IGFsbCB2aXNhcyBmb3IgdGhlc2UgZW1wbG95ZWVzXG4gICAgICAgIGNvbnN0IHsgZGF0YTogdmlzYXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oXCJ2aXNhc1wiKVxuICAgICAgICAgICAgLnNlbGVjdChcIipcIilcbiAgICAgICAgICAgIC5pbihcImVtcGxveWVlX2lkXCIsIGVtcGxveWVlSWRzKVxuICAgICAgICAgICAgLm9yZGVyKFwiZXhwaXJ5X2RhdGVcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG5cbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcblxuICAgICAgICAvLyBBdHRhY2ggZW1wbG95ZWUgaW5mbyB0byBlYWNoIHZpc2FcbiAgICAgICAgY29uc3QgdmlzYXNXaXRoRW1wbG95ZWVzID0gdmlzYXM/Lm1hcCgodmlzYSkgPT4gKHtcbiAgICAgICAgICAgIC4uLnZpc2EsXG4gICAgICAgICAgICBlbXBsb3llZTogZW1wbG95ZWVzLmZpbmQoKGUpID0+IGUuaWQgPT09IHZpc2EuZW1wbG95ZWVfaWQpLFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHZpc2FzV2l0aEVtcGxveWVlcyB8fCBbXSk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQVBJIEVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVSb3V0ZUhhbmRsZXJDbGllbnQoeyBjb29raWVzIH0pO1xuICAgICAgICBjb25zdCB7IGRhdGE6IHsgc2Vzc2lvbiB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcblxuICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2aXNhU2NoZW1hLnNhZmVQYXJzZShib2R5KTtcblxuICAgICAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHZhbGlkYXRpb24uZXJyb3IsIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbShcInByb2ZpbGVzXCIpXG4gICAgICAgICAgICAuc2VsZWN0KFwiY29tcGFueV9pZFwiKVxuICAgICAgICAgICAgLmVxKFwiaWRcIiwgc2Vzc2lvbi51c2VyLmlkKVxuICAgICAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICAgIGlmICghcHJvZmlsZT8uY29tcGFueV9pZCkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTm8gY29tcGFueVwiIH0sIHsgc3RhdHVzOiA0MDMgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWZXJpZnkgZW1wbG95ZWUgYmVsb25ncyB0byBjb21wYW55XG4gICAgICAgIGNvbnN0IHsgZGF0YTogZW1wbG95ZWUgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbShcImVtcGxveWVlc1wiKVxuICAgICAgICAgICAgLnNlbGVjdChcImlkXCIpXG4gICAgICAgICAgICAuZXEoXCJpZFwiLCB2YWxpZGF0aW9uLmRhdGEuZW1wbG95ZWVfaWQpXG4gICAgICAgICAgICAuZXEoXCJjb21wYW55X2lkXCIsIHByb2ZpbGUuY29tcGFueV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICBpZiAoIWVtcGxveWVlKSB7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJFbXBsb3llZSBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBkYXRhOiB2aXNhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKFwidmlzYXNcIilcbiAgICAgICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgICAgICAgIC4uLnZhbGlkYXRpb24uZGF0YSxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHZhbGlkYXRpb24uZGF0YS5zdGF0dXMgfHwgXCJ2YWxpZFwiLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHZpc2EsIHsgc3RhdHVzOiAyMDEgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQVBJIEVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVJvdXRlSGFuZGxlckNsaWVudCIsImNvb2tpZXMiLCJOZXh0UmVzcG9uc2UiLCJ6IiwiZHluYW1pYyIsInZpc2FTY2hlbWEiLCJvYmplY3QiLCJlbXBsb3llZV9pZCIsInN0cmluZyIsInV1aWQiLCJ2aXNhX3R5cGUiLCJtaW4iLCJwZXJtaXRfbnVtYmVyIiwib3B0aW9uYWwiLCJpc3N1ZV9kYXRlIiwiZXhwaXJ5X2RhdGUiLCJjb3VudHJ5X2lzc3VlZCIsInN0YXR1cyIsImVudW0iLCJHRVQiLCJyZXF1ZXN0Iiwic3VwYWJhc2UiLCJkYXRhIiwic2Vzc2lvbiIsImF1dGgiLCJnZXRTZXNzaW9uIiwianNvbiIsInByb2ZpbGUiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJ1c2VyIiwiaWQiLCJzaW5nbGUiLCJjb21wYW55X2lkIiwiZW1wbG95ZWVzIiwibGVuZ3RoIiwiZW1wbG95ZWVJZHMiLCJtYXAiLCJlIiwidmlzYXMiLCJlcnJvciIsImluIiwib3JkZXIiLCJhc2NlbmRpbmciLCJ2aXNhc1dpdGhFbXBsb3llZXMiLCJ2aXNhIiwiZW1wbG95ZWUiLCJmaW5kIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJQT1NUIiwiYm9keSIsInZhbGlkYXRpb24iLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwiaW5zZXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/visas/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/set-cookie-parser","vendor-chunks/jose","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvisas%2Froute&page=%2Fapi%2Fvisas%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvisas%2Froute.ts&appDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fglennbundy%2FDesktop%2Fvisatrack-malta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();